<h2>Halo <%= @order.customer_name %>!</h2>

<p style="line-height: 1.5; margin-bottom: 2rem;">Pesanan kamu sudah berhasil dibayar. Berikut invoice pembeliannya:</p>

<table>
  <tr>
    <td style="background-color: #f2f2f2"><strong>Waktu Pemesanan</strong></td>
    <td><%= l @order.created_at.in_time_zone("Asia/Jakarta"), locale: :id, format: :long %></td>
  </tr>
  <tr>
    <td style="background-color: #f2f2f2"><strong>ID Pesanan</strong></td>
    <td><%= @order.order_id %></td>
  </tr>
  <tr>
    <td style="background-color: #f2f2f2"><strong>Nama Pemesan</strong></td>
    <td><%= @order.customer_name %></td>
  </tr>
  <tr>
    <td style="background-color: #f2f2f2"><strong>Kontak Pemesan</strong></td>
    <td><%= @order.customer_email_address %></td>
  </tr>
  <tr>
    <td style="background-color: #f2f2f2"><strong>Total Harga</strong></td>
    <td><%= idr @order.total_price %></td>
  </tr>
</table>

<% if @order.contains_physical_products? && @order.shipping_cost.present? %>
  <table style="margin-top: 1rem;">
    <tr>
      <td style="background-color: #f2f2f2"><strong>Subtotal Produk</strong></td>
      <td><%= idr (@order.total_price - @order.shipping_cost) %></td>
    </tr>
    <tr>
      <td style="background-color: #f2f2f2"><strong>Ongkos Kirim</strong></td>
      <td><%= idr @order.shipping_cost %></td>
    </tr>
    <tr>
      <td style="background-color: #f2f2f2"><strong>Total</strong></td>
      <td><%= idr @order.total_price %></td>
    </tr>
  </table>
<% end %>

<h3>Rincian</h3>

<table style="margin-top: 1rem;">
  <thead style="text-align: left;">
    <th>Nama</th>
    <th>Harga</th>
  </thead>
  <tbody>
    <% @products.each.with_index(1) do |item, index| %>
      <tr>
        <td>
          <%= item.orderable_name %>
          <% if item.product_variant.present? %>
            <span style="color: #666; font-size: 0.9em;">- <%= item.product_variant.name %></span>
          <% end %>
        </td>
        <td><%= idr item.orderable_price %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<% if @order.contains_physical_products? %>
  <h3>Informasi Pengiriman</h3>
  <table style="margin-top: 1rem;">
    <tr>
      <td style="background-color: #f2f2f2"><strong>Kurir</strong></td>
      <td><%= "#{@order.shipping_provider&.upcase} - #{@order.shipping_method}" %></td>
    </tr>
    <tr>
      <td style="background-color: #f2f2f2"><strong>Alamat</strong></td>
      <td><%= @order.address_line %></td>
    </tr>
    <% if @order.shipping_subdistrict %>
      <tr>
        <td style="background-color: #f2f2f2"><strong>Kelurahan</strong></td>
        <td><%= @order.shipping_subdistrict.name %></td>
      </tr>
    <% end %>
    <% if @order.shipping_district %>
      <tr>
        <td style="background-color: #f2f2f2"><strong>Kecamatan</strong></td>
        <td><%= @order.shipping_district.name %></td>
      </tr>
    <% end %>
    <% if @order.shipping_city %>
      <tr>
        <td style="background-color: #f2f2f2"><strong>Kota/Kabupaten</strong></td>
        <td><%= @order.shipping_city.name %></td>
      </tr>
    <% end %>
    <% if @order.shipping_province %>
      <tr>
        <td style="background-color: #f2f2f2"><strong>Provinsi</strong></td>
        <td><%= @order.shipping_province.name %></td>
      </tr>
    <% end %>
    <tr>
      <td style="background-color: #f2f2f2"><strong>Nomor Resi</strong></td>
      <td><%= @order.tracking_number || "Belum tersedia" %></td>
    </tr>
  </table>
<% end %>
 
<p style="line-height: 1.5; margin-top: 2rem;">Terima kasih sudah belanja di <%= Setting.site_name.value %> yaa!</p>

<p style="line-height: 1.5; margin-top: 3rem;">
  Salam,<br>
  <%= Setting.email_sender_name.value %>
</p>
 

