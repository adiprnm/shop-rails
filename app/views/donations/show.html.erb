<% title = "Pembayaran Donasi | #{ Current.settings["site_name"] }" %>
<% description = "Pembayaran donasi di #{ Current.settings["site_name"] }" %>

<%= content_for(:title) { title } %>
<%= content_for(:head) do %>
  <%= tag.meta name: "robots", content: "noindex" %>
  <%= tag.meta name: "description", content: description %>
  <%= tag.meta name: "og:title", content: title %>
  <%= tag.meta name: "og:description", content: description %>
<% end %>

<div class="text-center">
  <%= status_tag(@donation) %>

  <h1 class="mt-4" style="font-size: 2rem; font-weight: 800;"><%= idr @donation.amount %></h1>

  <% if @donation.pending? || @donation.failed? %>
    <p class="mb-8">Bayar sebelum <%= tag.strong l(@donation.will_expire_at, format: :long, locale: :id) %></p>
  <% end %>

  <% if @donation.pending? || @donation.failed? %>
    <% if @donation.failed? %>
      <p>Donasi kamu belum bisa kami proses dikarenakan alasan sebagai berikut:</p>
      <article class="w-max mx-auto">
        <%= tag.strong @donation.remark %>
      </article>
      <p class="mt-4 mb-0">Harap lakukan aksi perbaikan sesuai dengan keterangan tersebut. Mohon maaf atas ketidaknyamanan ini.</p>
      <hr class="mt-8 mb-8">

    <% end %>

    <% if @donation.latest_payment_evidence && !@donation.latest_payment_evidence.checked? %>
      <p class="mt-8 mb-8">Bukti pembayaran sudah berhasil diunggah. Kami akan memverifikasi pembayaran maksimal dalam 1 x 24 jam.</p>
    <% else %>
      <p class="mt-8"><a role="button" href="<%= new_support_payment_evidence_path(@donation.donation_id) %>">Unggah Bukti Pembayaran</a></p>
      <p class="mt-8 mb-8">Silahkan lakukan pembayaran melalui salah satu dari metode pembayaran berikut ini:</p>

      <% if Current.settings["payment_qris"].present? %>
        <div class="mx-auto">
          <article>
            <h2 class="payment-method-name">QRIS</h2>
            <%= image_tag Current.settings["payment_qris"], class: "qris" %>
          </article>
        </div>
      <% end %>

      <% if Current.settings["payment_account_name"].present? && Current.settings["payment_account_number"].present? %>
        <article class="mt-8" data-controller="copy-text">
          <h2 class="payment-method-name"><%= Current.settings["payment_account_name"] %></h2>
          <p style="font-size: 1.5rem; font-weight: bold;"><%= Current.settings["payment_account_number"] %></p>
          <button data-account-number="<%= Current.settings["payment_account_number"] %>" data-action="copy-text#perform">Salin</button>
          <dialog data-copy-text-target="modal">
            <article>
              <p>Nomor rekening berhasi disalin!</p>
              <button data-action="copy-text#closeModal">Tutup</button>
            </article>
          </dialog>
        </article>
      <% end %>
    <% end %>
  <% elsif @donation.paid? %>
    <p>Donasi berhasil diverifikasi dan sudah ditampilkan di <%= link_to "halaman ini", supports_path %>. Terima kasih, orang baik!</p>
  <% elsif @donation.expired? %>
    <p>Oops! Donasi kamu sudah kadaluarsa. Silahkan lakukan donasi kembali.</p>
    <%= link_to "Kembali ke Beranda", products_path, role: "button" %>
  <% end %>

</div>

